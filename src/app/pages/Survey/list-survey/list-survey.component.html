<div class="content-container">
  <h2> {{'Surveys' |translate}}
  </h2>
  <hr/>  
  <button
    class="special-button mb-3"
    [hidden]="!this.canAdd"
    type="button"
    (click)="ShowAdd()"
  >
    {{ "Add" | translate }}
  </button>
  <nb-card class="table-container">
    <table
      class="users-table table-striped"
      mat-table
      [dataSource]="dataSource"
      matSort
      (matSortChange)="sortData($event)"
      matSortDisableClear
      matSortDirection="asc"
    >
      <!-- lawNumber Column -->
      <ng-container matColumnDef="Survey">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ "Survey" | translate }}
        </th>
        <td mat-cell *matCellDef="let element">
          <!-- {{element.planName}} -->

          <span *ngIf="element.surveyName == ''; else data">
            <input
              type="text"
              #surveyFilter
              nbInput
              class="w-30 mw-30"
              matInput
              (keyup)="applyFilter($event)"
              [placeholder]="'Survey' |translate" 
                            class="text-center"
            />
          </span>
          <ng-template #data>
            <span>{{ element.surveyName| sliceWords:0:10 }}{{"..."}}</span>
          </ng-template>
        </td>
      </ng-container>
      <ng-container matColumnDef="FromDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ "FromDate" | translate }}
        </th>
        <td mat-cell *matCellDef="let element">
          <!-- {{element.planCode}} -->

          <span *ngIf="element.surveyName == ''; else data">
            <!--   <input type="text"
                        #departmentFilter
                        nbInput
                        class="w-30 mw-30"
                        matInput
                        (keyup)="applyFilter($event)"
                        placeholder="الادارة"
                        class="text-center"
                      /> -->
          </span>
          <ng-template #data>
            <span>{{ element.fromDateStr }}</span>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="ToDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ "ToDate" | translate }}
        </th>
        <td mat-cell *matCellDef="let element">
          <!-- {{element.planCode}} -->

          <span *ngIf="element.surveyName == ''; else data">
            <!-- <input type="text"
                      #empFilter
                      nbInput
                      class="w-30 mw-30"
                      matInput
                      (keyup)="applyFilter($event)"
                      placeholder="الموظف"
                      class="text-center"
                    /> -->
          </span>
          <ng-template #data>
            <span>{{ element.toDateStr }}</span>
          </ng-template>
        </td>
      </ng-container>
      <!-- <ng-container matColumnDef="actions3">
        <th mat-header-cell *matHeaderCellDef>qr  </th>
        <td mat-cell *matCellDef="let element">

          <span *ngIf="element.sortable ==false;else data">

          </span>
          <ng-template #data>
            <span>

            <img width="250px" height="150px" src="{{element.surveyQr}}">

          </span>
          </ng-template>


        </td>
    </ng-container>   -->

      <ng-container matColumnDef="actions2">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="element.sortable == false; else data"> </span>
          <ng-template #data>
            <span>
              <button
                mat-mini-fab
                color="primary"
                [hidden]="!this.canEdit"
                (click)="ShowEdit(element.id)"
              >
                <mat-icon>edit</mat-icon>
              </button>
            </span>
          </ng-template>
        </td>
      </ng-container>
      <ng-container matColumnDef="actions1">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="element.sortable == false; else data"> </span>
          <ng-template #data>
            <span>
              <button
                mat-mini-fab
                color="warn"
                [hidden]="!this.canDelete"
                (click)="delete(element.id, element.surveyName)"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </span>
          </ng-template>
        </td>
      </ng-container>
      <ng-container matColumnDef="showCharts">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="element.sortable == false; else data"> </span>
          <ng-template #data>
            <span>
              <button
                mat-mini-fab
                color="warn"
                (click)="ShowCharts1(element.id)"
              >
                <!--               (click)="ShowCharts(element.questionNames)"
 -->
                <mat-icon>pie_chart</mat-icon>

                <!--  <mat-icon>qr_code</mat-icon>
 -->
              </button>
            </span>
          </ng-template>
        </td>
      </ng-container>
      <ng-container matColumnDef="showQrCode">
        <th mat-header-cell *matHeaderCellDef>QrCode</th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="element.sortable == false; else data"> </span>
          <ng-template #data>
            <span>
              <button
                mat-mini-fab
                color="warn"
                (click)="ShowQrCode(element.surveyName, element.surveyQr)"
              >
                <!--               (click)="ShowCharts(element.questionNames)"
 -->

                <mat-icon>qr_code</mat-icon>
              </button>
            </span>
          </ng-template>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </nb-card>
  <mat-paginator
    [dir]="dir"
    [length]="totalRecords"
    [pageIndex]="searchModel.PageNumber - 1"
    [pageSize]="searchModel.PageSize"
    [pageSizeOptions]="pageSizeOptions"
    (page)="search($event)"
    showFirstLastButtons
  ></mat-paginator>
</div>
